Product Requirements Document (PRD)
Система антиплагиата БГУИР
Версия: 1.0
Дата: 2025
Автор: Команда разработки БГУИР
Статус: Production Ready
1. ВВЕДЕНИЕ
1.1 Назначение документа
Настоящий документ Product Requirements Document (PRD) описывает требования к веб-приложению для автоматизированной проверки документов на плагиат, разработанному для Белорусского государственного университета информатики и радиоэлектроники (БГУИР). Документ предназначен для разработчиков, тестировщиков, менеджеров проекта и заинтересованных сторон.
1.2 Область применения
Система антиплагиата БГУИР предназначена для:
Автоматизированной проверки студенческих работ (курсовые, дипломные, лабораторные) на наличие плагиата
Выявления текстовых совпадений между документами в базе данных
Поддержки рабочего процесса проверки документов преподавателями
Интеграции с существующей инфраструктурой университета через LDAP
1.3 Целевая аудитория
Основные пользователи:
Студенты — загружают документы для проверки, просматривают результаты анализа оригинальности
Преподаватели — проверяют загруженные студентами документы, оценивают результаты проверки, ставят оценки
Администраторы системы — управляют системой, настраивают параметры, отслеживают производительность
2. ОПИСАНИЕ ПРОБЛЕМЫ И РЕШЕНИЯ
2.1 Проблематика
В современном образовательном процессе высших учебных заведений существует необходимость проверки студенческих работ на плагиат. Ручная проверка документов:
Требует значительных временных затрат от преподавателей
Не обеспечивает объективность оценки
Затруднена при большом количестве документов
Не позволяет эффективно выявлять случаи частичного заимствования текста
2.2 Предлагаемое решение
Веб-приложение с использованием технологий машинного обучения и векторного поиска, которое:
Автоматически извлекает текст из загруженных документов (PDF, DOCX)
Векторизует тексты с использованием моделей sentence-transformers
Находит похожие документы по косинусному сходству векторов
Проводит детальный анализ схожести с использованием множественных метрик
Предоставляет понятный интерфейс для студентов и преподавателей
Обеспечивает асинхронную обработку документов для мгновенного отклика системы
3. ФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ
3.1 Аутентификация и авторизация
3.1.1 LDAP аутентификация
Приоритет: Высокий
Описание: Система должна интегрироваться с LDAP сервером БГУИР для единой аутентификации пользователей.
Требования:
Поддержка LDAP сервера: `ldaps://ldap.bsuir.by`
Поиск пользователей в базовых DN:
`ou=staff,dc=bsuir,dc=by` (преподаватели)
`ou=stud,dc=bsuir,dc=by` (студенты)
Автоматическое создание пользователей в системе при первой авторизации через LDAP
Синхронизация атрибутов: имя, фамилия, email из LDAP
Fallback на стандартную Django аутентификацию для локальных пользователей
Технические детали:
Использование библиотеки `ldap3==2.9.1`
Кастомный backend аутентификации `LDAPBackend` в `app/ldap_auth_backend.py`
Безопасное хранение учетных данных LDAP администратора
3.1.2 Роли пользователей
Приоритет: Высокий
Описание: Система должна поддерживать различные роли пользователей с соответствующими правами доступа.
Роли:
Студент (обычный пользователь)
Видит только свои загруженные документы
Может загружать новые документы
Просматривает результаты проверки оригинальности
Может отправлять документы на защиту (менять статус на "На защите")
Преподаватель (`is_staff=True`)
Видит все документы в системе
Может просматривать документы со статусом "На защите"
Может менять статус документа: "Зачтен" или "Не зачтен"
Имеет доступ к поиску документов по ФИО студентов
Администратор (`is_superuser=True`)
Все права преподавателя
Доступ к Django Admin панели
Управление пользователями и настройками системы
Просмотр статистики и мониторинг
3.2 Управление документами
3.2.1 Загрузка документов
Приоритет: Критический
Описание: Пользователи должны иметь возможность загружать документы для проверки на плагиат.
Требования:
Поддержка форматов: PDF, DOCX
Максимальный размер файла: 50 МБ
Валидация формата файла при загрузке
Автоматическое присвоение уникального имени документу (с timestamp при дублировании)
Связывание документа с пользователем, загрузившим его
Выбор типа работы (лабораторная, курсовая, дипломная и т.д.)
Процесс загрузки:
Пользователь выбирает файл через форму
Указывает название документа (опционально, можно использовать имя файла)
Выбирает тип работы из списка
Система сохраняет документ и устанавливает статус "В очереди"
Документ автоматически отправляется на асинхронную обработку
3.2.2 Обработка документов
Приоритет: Критический
Описание: Система должна автоматически обрабатывать загруженные документы для извлечения текста и анализа плагиата.
Этапы обработки:
Этап 1: Извлечение текста
Для PDF: использование библиотеки `pdfminer.six==20240706`
Извлечение текста из текстовых контейнеров
Игнорирование таблиц и графических элементов
Очистка текста от артефактов форматирования
Разделение на главы и секции
Удаление служебной информации (министерство, оглавление и т.д.)
Для DOCX: использование библиотеки `python-docx==1.1.0`
Извлечение текста из параграфов
Извлечение текста из таблиц с сохранением структуры
Сохранение извлеченного текста в формате TXT
Этап 2: Векторизация текста
Использование модели `sentence-transformers` (парафразная модель `paraphrase-MiniLM-L6-v2`)
Разбиение текста на главы и предложения
Генерация векторов для каждого предложения (384-мерные векторы)
Усреднение векторов предложений внутри глав
Усреднение векторов глав для получения финального вектора документа
Сохранение вектора в базе данных в формате JSON
Этап 3: Анализ плагиата
Поиск похожих документов по косинусному сходству векторов
Порог схожести: 0.6 (настраиваемый параметр)
Детальный анализ с найденными похожими документами
Технические требования:
Обработка должна быть асинхронной через Celery
Поддержка синхронного режима как fallback при недоступности Celery
Обработка ошибок с информативными сообщениями
Прогресс обработки отслеживается через API
3.2.3 Статусы документов
Приоритет: Высокий
Описание: Каждый документ имеет статус, отражающий его состояние в рабочем процессе.
Статусы:
"В очереди" (`processing_status='queue'`) — документ загружен, ожидает обработки
"Обрабатывается" (`processing_status='processing'`) — документ находится в процессе анализа
"Завершено" (`processing_status='completed'`) — обработка завершена успешно
"Ошибка" (`processing_status='failed'`) — обработка завершилась с ошибкой
Статусы в рабочем процессе:
"На защите" — документ отправлен студентом на проверку преподавателю
"Зачтен" — документ проверен преподавателем и зачтен
"Не зачтен" — документ проверен и не зачтен
3.2.4 Просмотр документов
Приоритет: Высокий
Описание: Пользователи должны иметь возможность просматривать информацию о документах и результаты анализа.
Информация о документе:
Название документа
Имя пользователя (студента)
Дата и время загрузки
Тип работы
Текущий статус
Результат проверки оригинальности (в процентах)
Ссылка на скачивание оригинального файла
Детальная информация о проверке:
Процент оригинальности
Процент схожести
Список похожих документов с указанием уровня схожести
Детальный анализ схожести:
Схожесть по шинглам (1-граммы, 3-граммы, 5-граммы)
Схожесть по словам
Схожесть по символам
Схожесть по предложениям
Уровень риска плагиата: `very_low`, `low`, `medium`, `high`, `very_high`
3.3 Анализ плагиата
3.3.1 Алгоритм детекции плагиата
Приоритет: Критический
Описание: Система использует многоуровневый алгоритм для выявления плагиата.
Уровень 1: Поиск похожих документов (векторный поиск)
Вычисление косинусного сходства между вектором текущего документа и всеми документами в базе
Порог схожести: 0.6
Выбор топ-N похожих документов (N=5 по умолчанию)
Использование кэширования для ускорения повторных вычислений
Уровень 2: Детальный текстовый анализ
Для каждой пары "текущий документ - похожий документ" выполняется:
Анализ шинглов:
Генерация хэшированных шинглов размеров 1, 3, 5 слов
Вычисление коэффициента Жаккара для каждого размера шинглов
Взвешивание: shingle_1 (30%), shingle_3 (40%), shingle_5 (20%)
Анализ слов:
Создание множеств уникальных слов из обоих текстов
Вычисление пересечения и объединения множеств
Коэффициент Жаккара для слов (вес: 10%)
Анализ символов:
Подсчет частоты каждого символа
Вычисление схожести по формуле Жаккара
Анализ предложений:
Разбиение текстов на предложения
Попарное сравнение предложений
Усреднение схожести предложений
Уровень 3: Расчет оригинальности
Для каждого похожего документа вычисляется оригинальность отдельно
Берется минимальная оригинальность (худший случай)
Формула: `originality = 100 - (similarity * 100) - 0.01`
Ограничение результата диапазоном [0, 100]
3.3.2 Классификация риска плагиата
Приоритет: Высокий
Описание: Система классифицирует документы по уровню риска плагиата.
Уровни риска:
very_low — максимальная схожесть < 0.5
low — максимальная схожесть между 0.5 и 0.7
medium — максимальная схожесть между 0.7 и 0.8
high — максимальная схожесть между 0.8 и 0.9
very_high — максимальная схожесть > 0.9
Определение плагиата:
Документ считается плагиатом, если:
Оригинальность < 85% (настраиваемый порог), ИЛИ
Максимальная схожесть > 0.8
3.3.3 Оптимизация производительности
Приоритет: Средний
Описание: Система должна эффективно работать с большим количеством документов.
Методы оптимизации:
Кэширование векторов: векторы документов кэшируются в Redis на 1 час
Кэширование схожести: результаты сравнения документов кэшируются на 2 часа
Индексы базы данных: создание индексов для ускорения поиска
Пакетная обработка: возможность обработки нескольких документов одновременно
3.4 Интерфейс пользователя
3.4.1 Личный кабинет студента
Приоритет: Высокий
Описание: Студенты должны иметь удобный интерфейс для работы со своими документами.
Функциональность:
Список всех загруженных документов с пагинацией (10 документов на страницу)
Форма загрузки нового документа
Поиск документов по названию
Отображение статуса обработки каждого документа:
"В очереди" — документ ожидает обработки
"Обрабатывается" — идет анализ (с индикатором прогресса)
"Завершено" — обработка завершена, отображается процент оригинальности
"Ошибка" — обработка завершилась с ошибкой, показывается сообщение об ошибке
AJAX-обновление статуса обработки без перезагрузки страницы
Кнопка "Отправить на защиту" (меняет статус на "На защите")
Просмотр детальной информации о проверке
UX требования:
Интуитивно понятный интерфейс
Live-обновление статусов обработки
Информативные сообщения об ошибках
Поддержка мобильных устройств (responsive design)
3.4.2 Интерфейс преподавателя
Приоритет: Высокий
Описание: Преподаватели должны иметь интерфейс для проверки документов студентов.
Функциональность:
Список документов со статусом "На защите" с пагинацией
Поиск документов по ФИО студента
Просмотр детальной информации о документе:
Информация о студенте
Процент оригинальности
Детальный анализ схожести
Список похожих документов
Скачивание оригинального файла
Кнопки для оценки:
"Зачтен" — документ зачтен
"Не зачтен" — документ не зачтен
Просмотр всех документов в системе (для администраторов)
3.4.3 API для мониторинга
Приоритет: Средний
Описание: API endpoints для получения статуса обработки документов.
Endpoints:
`GET /documents/status/<document_id>/` — получение статуса обработки документа
Возвращает JSON с информацией о статусе, оригинальности, ошибках
Используется для AJAX-обновления интерфейса
3.5 Массовые операции
3.5.1 Пакетная загрузка документов
Приоритет: Средний
Описание: Возможность загружать несколько документов одновременно.
Требования:
Загрузка множественных файлов через одну форму
Создание пакета документов (`DocumentBatch`)
Автоматическое добавление всех документов в очередь обработки
Отслеживание статуса обработки пакета
Статистика по пакету: общее количество, обработано, ошибок
3.5.2 Пакетная обработка
Приоритет: Средний
Описание: Обработка выбранных документов пакетом.
Требования:
Выбор нескольких документов из списка
Создание пакета для обработки
Параллельная обработка документов через Celery
Мониторинг прогресса пакетной обработки
3.5.3 Пересчет оригинальности
Приоритет: Низкий
Описание: Возможность пересчитать оригинальность для существующих документов.
Use cases:
После добавления новых документов в базу
После изменения алгоритма анализа
При необходимости обновления результатов
4. НЕФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ
4.1 Производительность
4.1.1 Время отклика
Время отклика интерфейса: < 1 секунда
Время обработки документа (асинхронно): 30-60 секунд для типичного документа
Время обработки при синхронном режиме: то же, но блокирует запрос
4.1.2 Пропускная способность
Одновременная обработка: 4-8 документов (зависит от ресурсов сервера)
Поддержка параллельных пользователей: до 100 одновременных сессий
4.1.3 Масштабируемость
Возможность горизонтального масштабирования через добавление Celery workers
Поддержка распределенной обработки через Redis
Оптимизация базы данных для работы с большими объемами данных
4.2 Надежность
4.2.1 Отказоустойчивость
Обработка ошибок с информативными сообщениями
Автоматический retry при ошибках обработки (до 3 попыток)
Fallback на синхронную обработку при недоступности Celery
Сохранение данных при сбоях
4.2.2 Доступность
Целевая доступность: 99% (допускается простой для технического обслуживания)
Мониторинг состояния сервисов (база данных, Redis, Celery)
Health checks для всех компонентов
4.3 Безопасность
4.3.1 Аутентификация и авторизация
Интеграция с LDAP для единой аутентификации
Хранение секретных ключей в переменных окружения
Защита от CSRF атак
Безопасное хранение сессий
4.3.2 Защита данных
Ограничение доступа к документам (студенты видят только свои документы)
Валидация загружаемых файлов (размер, формат)
Защита от загрузки вредоносных файлов
Шифрование соединения с базой данных (в продакшене)
4.3.3 Настройки безопасности
`DEBUG=False` в продакшене
`ALLOWED_HOSTS` фильтрация
Secure cookies при использовании HTTPS
Защита от SQL injection через ORM Django
4.4 Удобство использования
4.4.1 Интерфейс
Интуитивно понятный интерфейс
Минимальная кривая обучения
Информативные сообщения об ошибках
Поддержка русского языка
4.4.2 Отзывчивость
Поддержка мобильных устройств (responsive design)
Быстрая загрузка страниц
Live-обновление статусов обработки
4.5 Совместимость
4.5.1 Браузеры
Современные версии Chrome, Firefox, Safari, Edge
Поддержка JavaScript (требуется для AJAX функциональности)
4.5.2 Форматы файлов
PDF (версии 1.4 и выше)
DOCX (Microsoft Office 2007 и выше)
4.6 Масштабируемость и расширяемость
4.6.1 Архитектура
Модульная архитектура Django приложений
Разделение логики детекторов плагиата (базовый класс и продвинутый)
Возможность добавления новых методов детекции
4.6.2 База данных
PostgreSQL с расширением pgvector для векторного поиска
Поддержка индексов для оптимизации запросов
Возможность миграции данных
5. ТЕХНИЧЕСКАЯ АРХИТЕКТУРА
5.1 Технологический стек
5.1.1 Backend
Django 4.2.9 — веб-фреймворк
Модели данных (ORM)
Представления (Views)
Шаблоны (Templates)
Формы и валидация
Admin панель
5.1.2 База данных
PostgreSQL 16.4 с расширением pgvector
Хранение документов, пользователей, статусов
Векторные индексы для быстрого поиска
Транзакционная целостность данных
5.1.3 Асинхронная обработка
Celery 5.3.4 — распределенная очередь задач
Redis 7 — брокер сообщений и кэш
Хранение результатов задач
Кэширование векторов и результатов схожести
Flower 2.0.1 — веб-интерфейс для мониторинга Celery
5.1.4 Машинное обучение и NLP
sentence-transformers 2.2.2 — векторизация текстов
Модель: `paraphrase-MiniLM-L6-v2` (384-мерные векторы)
torch 2.5.1 — backend для ML моделей
transformers 4.35.0 — библиотека трансформеров
numpy 2.0.2 — математические вычисления
5.1.5 Обработка документов
pdfminer.six 20240706 — извлечение текста из PDF
python-docx 1.1.0 — извлечение текста из DOCX
PyMuPDF 1.23.0+ — дополнительная поддержка PDF
Pillow 10.0.0+ — обработка изображений
5.1.6 Аутентификация
ldap3 2.9.1 — интеграция с LDAP сервером БГУИР
5.1.7 Веб-сервер
Gunicorn — WSGI HTTP сервер для Python
3 workers для обработки запросов
Nginx (опционально для продакшена) — reverse proxy и статические файлы
5.1.8 Развертывание
Docker — контейнеризация приложения
docker-compose — оркестрация сервисов
Entrypoint скрипт — автоматическая инициализация
5.2 Структура проекта
Plagiarism_detection_bsuir/
├── Folder/                         # Django проект
│   ├── app/                        # Настройки приложения
│   │   ├── settings.py             # Конфигурация (env-based)
│   │   ├── celery.py               # Настройки Celery
│   │   ├── urls.py                 # Главные маршруты
│   │   ├── ldap_auth_backend.py    # LDAP аутентификация
│   │   ├── wsgi.py                 # WSGI конфигурация
│   │   └── asgi.py                 # ASGI конфигурация
│   ├── documents/                  # Основное приложение
│   │   ├── detectors/              # Детекторы плагиата
│   │   │   ├── base_detector.py   # Базовый класс детектора
│   │   │   └── advanced_detector.py # Продвинутый детектор
│   │   ├── management/commands/    # CLI команды
│   │   │   └── reprocess_documents.py # Пересчет документов
│   │   ├── migrations/             # Миграции БД
│   │   ├── templates/              # HTML шаблоны
│   │   │   └── documents/
│   │   │       ├── cab.html       # Личный кабинет
│   │   │       ├── file.html      # Страница документа
│   │   │       └── results-cab.html # Результаты проверки
│   │   ├── models.py               # Модели данных
│   │   ├── views.py                # Контроллеры
│   │   ├── batch_views.py         # Массовые операции
│   │   ├── tasks.py                # Celery задачи
│   │   ├── processing.py           # Синхронная обработка
│   │   ├── forms.py                # Формы
│   │   ├── urls.py                 # Маршруты документов
│   │   ├── docx_extractor.py       # Извлечение текста из DOCX
│   │   ├── text_clining.py         # Очистка текста из PDF
│   │   ├── vector.py               # Векторизация текстов
│   │   ├── sim_cos.py              # Алгоритмы схожести
│   │   ├── utils.py                # Утилиты поиска
│   │   ├── utils_cache.py          # Redis кэширование
│   │   └── vector_models.py        # Векторные модели БД
│   ├── users/                      # Управление пользователями
│   │   ├── models.py               # Модель пользователя
│   │   ├── views.py                # Представления
│   │   ├── forms.py                # Формы авторизации
│   │   └── urls.py                 # Маршруты пользователей
│   ├── static/                     # Статические файлы
│   │   ├── css/                    # Стили
│   │   ├── js/                     # JavaScript
│   │   └── assets/                 # Изображения и ресурсы
│   ├── media/                      # Загруженные документы
│   │   ├── documents/              # Оригинальные файлы
│   │   └── txt_files/              # Извлеченные тексты
│   └── manage.py                   # Django CLI
├── docker-compose.yml              # Docker Compose конфигурация
├── docker-compose.prod.yml         # Production конфигурация
├── Dockerfile                      # Docker образ
├── entrypoint.sh                   # Скрипт инициализации
├── nginx.conf                      # Nginx конфигурация
├── requirements.txt               # Python зависимости
├── env.template                    # Шаблон переменных окружения
├── start_all.bat                   # Запуск всех сервисов (Windows)
├── stop_all.bat                    # Остановка сервисов (Windows)
└── README.md                       # Документация проекта
5.3 Модели данных
5.3.1 User (Пользователь)
Расширенная модель Django User для хранения дополнительной информации:
`sur_name` — отчество
`image` — аватар пользователя
Интеграция с LDAP
5.3.2 Document (Документ)
Основная модель для хранения документов:
`user` — пользователь, загрузивший документ
`name` — название документа (уникальное)
`result` — процент оригинальности (Decimal 5,2)
`status` — статус в рабочем процессе (FK к Status)
`type` — тип работы (FK к Type)
`time_created` — дата и время загрузки
`data` — файл документа (FileField)
`txt_file` — извлеченный текст (FileField)
`vector` — векторное представление текста (TextField, JSON)
`last_status_changed_by` — пользователь, изменивший статус
`processing_status` — статус обработки ('queue', 'processing', 'completed', 'failed')
`processing_started_at` — начало обработки
`processing_completed_at` — завершение обработки
`processing_error` — ошибка обработки
`detailed_analysis` — детальный анализ плагиата (JSONField)
5.3.3 Status (Статус)
Статусы документов в рабочем процессе:
`name` — название статуса
`html_clase` — CSS класс для отображения
5.3.4 Type (Тип работы)
Типы работ:
`name` — название типа (лабораторная, курсовая, дипломная и т.д.)
5.3.5 SimilarDocument (Похожий документ)
Связь между документами с указанием схожести:
`document` — исходный документ
`similar_document` — похожий документ
`similarity_score` — коэффициент схожести
5.3.6 DocumentVector (Вектор документа)
Модель для хранения векторов в pgvector:
`document` — связь с документом (OneToOne)
`vector` — вектор документа (VectorField, 384 измерения)
`normalized_vector` — нормализованный вектор для быстрого косинусного сходства
`vector_norm` — норма вектора
5.3.7 DocumentSimilarity (Схожесть документов)
Кэширование результатов сравнения:
`document1`, `document2` — пара документов
`cosine_similarity` — косинусное сходство
`jaccard_similarity` — схожесть Жаккара
`dice_similarity` — схожесть Дайса
`levenshtein_similarity` — схожесть Левенштейна
`weighted_similarity` — взвешенная схожесть
`is_paraphrasing` — является ли парафразингом
`confidence_score` — уверенность анализа
5.3.8 DocumentBatch (Пакет документов)
Модель для пакетной обработки:
`name` — название пакета
`status` — статус обработки пакета
`total_documents` — общее количество документов
`processed_documents` — обработано
`failed_documents` — ошибок
`created_by` — создатель пакета
5.3.9 DocumentProcessingQueue (Очередь обработки)
Очередь для обработки документов:
`document` — документ для обработки
`batch` — пакет (опционально)
`priority` — приоритет (1-4)
`status` — статус в очереди
`retry_count` — количество попыток
5.4 Архитектура обработки
5.4.1 Асинхронная обработка через Celery
Поток обработки документа:
Загрузка документа:
Пользователь загружает файл через веб-интерфейс
Django сохраняет документ в БД со статусом `processing_status='queue'`
Вызывается Celery задача `process_document_plagiarism.delay(document_id)`
Извлечение текста (Celery worker):
Изменение статуса на `processing_status='processing'`
Определение типа файла (PDF или DOCX)
Извлечение текста с помощью соответствующей библиотеки
Очистка текста от артефактов
Сохранение текста в файл TXT
Обновление `txt_file` в модели Document
Векторизация (Celery worker):
Загрузка модели sentence-transformers (кэшируется после первой загрузки)
Разбиение текста на главы и предложения
Генерация векторов для предложений
Усреднение векторов для получения финального вектора документа
Сохранение вектора в БД (JSON формат)
Анализ плагиата (Celery worker):
Поиск похожих документов по косинусному сходству векторов
Для каждого похожего документа:
Детальный текстовый анализ (шинглы, слова, символы, предложения)
Вычисление оригинальности
Сохранение результатов в `result` и `detailed_analysis`
Изменение статуса на `processing_status='completed'`
Обработка ошибок:
При ошибке: статус `processing_status='failed'`, сохранение ошибки
Автоматический retry до 3 попыток с интервалом 60 секунд
5.4.2 Синхронная обработка (Fallback)
Если Celery/Redis недоступен:
Вызов функции `process_document_sync(document_id)`
Та же логика, но выполняется синхронно в том же запросе
Блокирует запрос на 30-60 секунд
Пользователь получает результат сразу
5.4.3 Кэширование
Redis кэш:
Векторы документов кэшируются на 1 час (ключ: `vector:{document_id}`)
Результаты сравнения документов кэшируются на 2 часа (ключ: `similarity:{doc1_id}:{doc2_id}`)
Ускорение повторных запросов и пересчета оригинальности
5.5 Конфигурация и развертывание
5.5.1 Переменные окружения
Система настраивается через переменные окружения (файл `.env`):
Django:
`SECRET_KEY` — секретный ключ Django
`DEBUG` — режим отладки (False для продакшена)
`ALLOWED_HOSTS` — разрешенные хосты
База данных:
`POSTGRES_DB` — название базы данных
`POSTGRES_USER` — пользователь PostgreSQL
`POSTGRES_PASSWORD` — пароль
`DATABASE_URL` — полный URL подключения (для Docker)
Celery/Redis:
`CELERY_BROKER_URL` — URL брокера Redis
`CELERY_RESULT_BACKEND` — backend для результатов
5.5.2 Docker развертывание
Сервисы:
postgres_db — PostgreSQL с pgvector
redis — Redis сервер
web — Django приложение (Gunicorn)
celery — Celery worker
flower — мониторинг Celery
Volumes:
`pgvector_data` — данные PostgreSQL
`media_files` — загруженные документы
`static_files` — собранные статические файлы
`hf_cache` — кэш моделей HuggingFace
5.5.3 Инициализация
Entrypoint скрипт:
Ожидание готовности PostgreSQL
Применение миграций Django
Сборка статических файлов
Запуск Gunicorn/Celery
6. ИНТЕРФЕЙСЫ И ИНТЕГРАЦИИ
6.1 LDAP интеграция
6.1.1 Описание
Интеграция с LDAP сервером БГУИР для единой аутентификации пользователей университета.
6.1.2 Конфигурация
LDAP сервер: `ldaps://ldap.bsuir.by`
Bind DN: `uid=smdoadmin,ou=staff,dc=bsuir,dc=by`
Base DN для поиска:
`ou=staff,dc=bsuir,dc=by` (преподаватели)
`ou=stud,dc=bsuir,dc=by` (студенты)
6.1.3 Процесс аутентификации
Пользователь вводит username и password в форму входа
Django пытается аутентифицировать через `LDAPBackend`
LDAP backend:
Подключается к LDAP серверу с административными учетными данными
Ищет пользователя по `uid` в обеих базах (staff и stud)
При нахождении пытается аутентифицировать с введенным паролем
При успехе создает или обновляет пользователя в Django БД
Синхронизирует атрибуты: имя, фамилия, email
Пользователь авторизован и перенаправляется в личный кабинет
6.1.4 Fallback
Если LDAP недоступен или пользователь не найден, система пробует стандартную Django аутентификацию (для локальных администраторов).
6.2 API Endpoints
6.2.1 REST API для документов
Получение статуса обработки:
`GET /documents/status/<document_id>/`
Возвращает JSON с информацией о статусе, оригинальности, ошибках
Используется для AJAX-обновления интерфейса
Пример ответа:
{
"document_id": 123,
"document_name": "Курсовая_работа.docx",
"processing_status": "completed",
"status_id": 2,
"status_name": "Проверен",
"result": 87.5,
"processing_started_at": "2025-01-15T10:00:00Z",
"processing_completed_at": "2025-01-15T10:00:30Z",
"processing_error": null,
"detailed_analysis": {
"originality": 87.5,
"similarity": 12.5,
"plagiarism_risk": "low",
"similar_documents": [...]
}
}
6.3 Интеграция с Flower
Flower предоставляет веб-интерфейс для мониторинга Celery:
URL: `http://localhost:5555`
Мониторинг активных задач
Статистика workers
История выполнения задач
Управление workers
7. БЕЗОПАСНОСТЬ
7.1 Аутентификация и авторизация
7.1.1 LDAP аутентификация
Использование защищенного соединения (LDAPS)
Хранение учетных данных администратора LDAP в коде (должно быть вынесено в переменные окружения в продакшене)
Проверка пароля пользователя через LDAP
7.1.2 Роли и права доступа
Разделение доступа по ролям (студент, преподаватель, администратор)
Проверка прав доступа в представлениях Django (`login_required`, проверка `is_staff`)
Студенты видят только свои документы
7.2 Защита данных
7.2.1 Файлы документов
Хранение в защищенной директории `media/documents/`
Валидация размера и формата файлов
Проверка прав доступа при скачивании
7.2.2 База данных
Использование ORM Django для защиты от SQL injection
Хранение чувствительных данных в переменных окружения
Резервное копирование базы данных (рекомендуется)
7.3 Защита от атак
7.3.1 CSRF защита
Встроенная защита Django от CSRF атак
Токены CSRF во всех формах
7.3.2 XSS защита
Автоматическое экранирование в шаблонах Django
Валидация входных данных
7.3.3 Настройки безопасности
`DEBUG=False` в продакшене (скрытие детальной информации об ошибках)
`ALLOWED_HOSTS` фильтрация разрешенных доменов
Secure cookies при использовании HTTPS
Защита от clickjacking через XFrameOptions
8. МОНИТОРИНГ И ЛОГИРОВАНИЕ
8.1 Мониторинг производительности
8.1.1 Flower
Веб-интерфейс для мониторинга Celery задач
Статистика выполнения задач
Мониторинг workers
8.1.2 Django Debug Toolbar (только в DEBUG режиме)
Отладка SQL запросов
Анализ производительности
Информация о запросах
8.2 Логирование
8.2.1 Уровни логирования
ERROR — критические ошибки
WARNING — предупреждения
INFO — информационные сообщения
DEBUG — детальная отладочная информация (только в DEBUG режиме)
8.2.2 Логирование операций
Ошибки обработки документов
Ошибки LDAP аутентификации
Ошибки векторизации
Ошибки анализа плагиата
9. ТЕСТИРОВАНИЕ
9.1 Типы тестирования
9.1.1 Функциональное тестирование
Проверка загрузки документов различных форматов
Проверка извлечения текста из PDF и DOCX
Проверка векторизации текстов
Проверка алгоритма детекции плагиата
Проверка расчета оригинальности
9.1.2 Интеграционное тестирование
Тестирование интеграции с LDAP
Тестирование Celery задач
Тестирование Redis кэширования
Тестирование взаимодействия компонентов
9.1.3 Тестирование производительности
Нагрузочное тестирование (множественные одновременные загрузки)
Тестирование времени обработки документов
Тестирование масштабируемости
9.1.4 Тестирование безопасности
Тестирование аутентификации и авторизации
Тестирование защиты от CSRF/XSS
Тестирование валидации файлов
9.2 Тестовые сценарии
9.2.1 Сценарий 1: Загрузка и обработка документа
Студент авторизуется в системе
Загружает PDF документ
Проверяет статус обработки (должен измениться с "В очереди" на "Обрабатывается", затем на "Завершено")
Просматривает результат оригинальности
9.2.2 Сценарий 2: Отправка на защиту и оценка
Студент отправляет документ на защиту (статус "На защите")
Преподаватель видит документ в списке "На защите"
Преподаватель просматривает детальную информацию
Преподаватель ставит оценку "Зачтен" или "Не зачтен"
9.2.3 Сценарий 3: Обнаружение плагиата
Загружается документ с высоким процентом схожести (>85%)
Система должна выявить похожие документы
Отображается предупреждение о возможном плагиате
Показывается список похожих документов
10. РАЗВИТИЕ И РАСШИРЯЕМОСТЬ
10.1 Возможности для расширения
10.1.1 Новые методы детекции
Архитектура поддерживает добавление новых детекторов плагиата
Базовый класс `BasePlagiarismDetector` для наследования
Возможность добавления новых метрик схожести
10.1.2 Поддержка новых форматов
Легко добавить поддержку новых форматов файлов (RTF, TXT и т.д.)
Модульная структура обработки документов
10.1.3 Интеграция с внешними системами
API для интеграции с другими системами университета
Webhooks для уведомлений о завершении обработки
Экспорт данных в различные форматы
10.2 Планы развития
10.2.1 Краткосрочные улучшения
Оптимизация производительности векторизации
Улучшение точности алгоритма детекции
Расширение функциональности административной панели
10.2.2 Долгосрочные планы
Поддержка проверки изображений в документах (OCR)
Интеграция с внешними базами данных плагиата
Машинное обучение для улучшения точности детекции
Мобильное приложение
11. ГЛОССАРИЙ
Векторизация — преобразование текста в числовой вектор с использованием моделей машинного обучения.
Косинусное сходство — метрика для измерения схожести между двумя векторами, вычисляемая как косинус угла между ними.
Шинглы — последовательности N слов (N-граммы), используемые для сравнения текстов.
Оригинальность — процент уникального текста в документе (100% = полностью оригинальный).
Схожесть — процент совпадений между документами (100% = идентичные документы).
Celery — распределенная система очередей задач для асинхронного выполнения задач.
Redis — хранилище данных в памяти, используемое как брокер для Celery и кэш.
pgvector — расширение PostgreSQL для работы с векторными данными.
LDAP — протокол для доступа к службам каталогов (Lightweight Directory Access Protocol).
Sentence Transformers — библиотека для генерации векторных представлений текстов.
12. ПРИЛОЖЕНИЯ
12.1 Диаграммы
12.1.1 Диаграмма архитектуры системы
┌─────────────┐
│   Browser   │
└──────┬──────┘
│ HTTP
▼
┌─────────────────┐
│   Nginx/Gunicorn│
│   (Django App)   │
└──────┬───────────┘
│
├──────────┬──────────────┐
▼          ▼              ▼
┌──────────┐ ┌──────────┐ ┌──────────┐
│PostgreSQL│ │  Redis   │ │  Celery  │
│+ pgvector│ │ (Cache)  │ │  Worker  │
└──────────┘ └──────────┘ └──────────┘
│          │              │
└──────────┴──────────────┘
│
▼
┌──────────────┐
│ LDAP Server  │
│  (БГУИР)     │
└──────────────┘
12.1.2 Диаграмма потока обработки документа
Загрузка документа
│
▼
Сохранение в БД
(status='queue')
│
▼
Celery задача
process_document_plagiarism
│
├─► Извлечение текста (PDF/DOCX)
│
├─► Векторизация текста
│   (sentence-transformers)
│
├─► Поиск похожих документов
│   (косинусное сходство)
│
├─► Детальный анализ
│   (шинглы, слова, символы)
│
└─► Расчет оригинальности
│
▼
Сохранение результатов
(status='completed')
12.2 Конфигурационные файлы
12.2.1 Пример .env файла
# Django настройки
SECRET_KEY=your-secret-key-here-generate-new-one
DEBUG=False
ALLOWED_HOSTS=localhost,127.0.0.1,antiplagiat.bsuir.by
# PostgreSQL
POSTGRES_DB=plagiarism_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-strong-password-here
# Для Docker
DATABASE_URL=postgres://postgres:your-password@db:5432/plagiarism_db
# Redis/Celery
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0
12.3 Примеры использования API
12.3.1 Получение статуса документа
curl http://localhost:8080/documents/status/123/
12.3.2 Загрузка документа через API
curl -X POST http://localhost:8080/documents/cabinet/ \
-F "name=Test_Document" \
-F "data=@document.pdf" \
-F "type=1"
13. ИСТОРИЯ ИЗМЕНЕНИЙ
14. КОНТАКТЫ И ПОДДЕРЖКА
Разработчик: Команда разработки БГУИР
Организация: Белорусский государственный университет информатики и радиоэлектроники (БГУИР)
Проект: Система антиплагиата БГУИР
Конец документа

[ТАБЛИЦЫ]
Версия | Дата | Автор | Описание изменений
1.0 | 2025 | Команда БГУИР | Первоначальная версия PRD